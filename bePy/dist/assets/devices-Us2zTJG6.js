import{E as _,r as y,G as r}from"./index-DaBQWeQ5.js";import{a as t}from"./apiFetch-g2B7VU1-.js";const S=_("devices",()=>{const a=y([]);function d(e){return{id:e.id,ipWeb:e.ip_web,ipNvr:e.ip_nvr,username:e.username,brand:e.brand,status:e.is_checked}}async function p(){const e=await t(`${r.BASE_URL}/api/devices`);a.value=e.map(d)}async function v(){const e=await t(`${r.BASE_URL}/api/devices/active`);a.value=e.map(d)}async function b(e){const s={ip_web:e.ipWeb,username:e.username,password:e.password,brand:e.brand};return await t(`${r.BASE_URL}/api/devices/test-connection`,{method:"POST",body:JSON.stringify(s)})}async function f(e){const s={ip_web:e.ipWeb,ip_nvr:e.ipNvr,username:e.username,password:e.password,brand:e.brand,is_checked:e.status??!0},i=await t(`${r.BASE_URL}/api/devices`,{method:"POST",body:JSON.stringify(s)});return await p(),i}async function m(e,s){const i=a.value.findIndex(u=>u.id==e),o=i!==-1?{...a.value[i]}:null;i!==-1&&o&&(a.value[i]={...o,...s});const c=o,n={};n.ip_web=s.ipWeb??c?.ipWeb,n.ip_nvr=s.ipNvr??c?.ipNvr,n.username=s.username??c?.username,n.brand=s.brand??c?.brand,s.status!==void 0?n.is_checked=s.status:n.is_checked=c?.status,s.password&&(n.password=s.password);try{await t(`${r.BASE_URL}/api/devices/${e}`,{method:"PUT",body:JSON.stringify(n)}),p()}catch(u){throw i!==-1&&o&&(a.value[i]=o),u}}async function w(e){await t(`${r.BASE_URL}/api/devices/${e}`,{method:"DELETE"}),await p()}return{devices:a,fetchDevices:p,fetchActiveDevices:v,testConnection:b,addDevice:f,updateDevice:m,deleteDevice:w}});export{S as u};
