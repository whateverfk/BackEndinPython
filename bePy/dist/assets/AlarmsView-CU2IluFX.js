import{E as z,r as p,G as g,d as E,A as j,C as L,c,a as t,e as d,b as v,j as x,f as a,p as C,z as M,i as b,t as f,T as S,F as T,n as D,o}from"./index-DX1pN3vs.js";import{a as w}from"./apiFetch-BMI3tozZ.js";import{B}from"./bell-hC6d3il2.js";import{T as k}from"./trash-2-IvUPxITq.js";import{C as $}from"./circle-check-Crz2u41C.js";import{L as V}from"./loader-circle-OwJbnJgk.js";import{Z as F}from"./zap-DFupKVUC.js";import{c as A}from"./createLucideIcon-91mxEY5P.js";import{M as U}from"./monitor-CCLFVsAs.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I=A("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const N=A("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);const H=A("video-off",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),R=z("alarms",()=>{const m=p([]),n=p(null),i=p(null),r=p(!0);async function u(l=!1){if(l||(m.value=[],n.value=null,i.value=null,r.value=!0),!r.value&&l)return;const e=new URLSearchParams;n.value&&e.append("cursor_time",n.value),i.value&&e.append("cursor_id",i.value.toString());const s=await w(`${g.BASE_URL}/api/user/alarm?${e.toString()}`);l?m.value.push(...s.items):m.value=s.items,n.value=s.next_cursor_time,i.value=s.next_cursor_id,r.value=s.has_more}async function h(){await u(!0)}async function _(l){await w(`${g.BASE_URL}/api/user/alarm/${l}`,{method:"DELETE"}),m.value=m.value.filter(e=>e.id!==l)}async function y(){await w(`${g.BASE_URL}/api/user/alarm`,{method:"DELETE"}),m.value=[],r.value=!1}return{alarms:m,hasMore:r,fetchAlarms:u,loadMore:h,deleteAlarm:_,deleteAll:y}}),O={class:"max-w-4xl mx-auto space-y-6 pb-12"},q={class:"flex items-center justify-between mb-8"},P={class:"text-3xl font-bold text-zinc-100 flex items-center gap-3"},Z={key:0,class:"glass-card py-24 flex flex-col items-center justify-center text-zinc-600"},K={class:"w-16 h-16 rounded-full bg-emerald-500/10 flex items-center justify-center mb-4 text-emerald-500/40"},W={key:1,class:"space-y-3"},J={class:"shrink-0 w-12 h-12 rounded-2xl bg-zinc-900 border border-white/5 flex items-center justify-center relative overflow-hidden"},Q={key:0,class:"absolute inset-0 bg-rose-500/10 animate-pulse"},X={class:"flex-1 min-w-0"},Y={class:"flex items-center gap-3 mb-1"},ee={class:"font-bold text-zinc-200"},te={class:"text-sm text-zinc-500 flex items-center gap-4"},se={class:"flex items-center gap-1.5"},ae={key:0,class:"flex items-center gap-1.5"},oe={class:"text-xs text-zinc-600 mt-1 italic"},le={class:"shrink-0 text-right"},ne={class:"text-xs font-mono text-zinc-600 group-hover:text-zinc-400 transition-colors"},re=["onClick"],ie={class:"flex justify-center pt-8"},ce=["disabled"],de={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-6"},me={class:"glass-card w-full max-w-sm p-10 relative z-10 text-center border-rose-500/20 shadow-4xl"},ue={class:"w-20 h-20 rounded-3xl bg-rose-500/10 flex items-center justify-center mx-auto mb-6 text-rose-500 border border-rose-500/20"},fe={class:"flex gap-4"},pe=E({__name:"AlarmsView",setup(m){const n=R(),i=L("notify"),r=p(!1),u=p(!1);j(()=>{h(!1)});const h=async(l=!0)=>{r.value=!0;try{await n.fetchAlarms(l),l&&i("Updated","Fetched older alarm events","info")}catch{i("Error","Failed to fetch alarms","error")}finally{r.value=!1}},_=async l=>{try{await n.deleteAlarm(l),i("Deleted","Alarm record removed","info")}catch{i("Error","Failed to delete alarm","error")}},y=async()=>{await n.deleteAll(),u.value=!1,i("Cleared","All alarms have been removed","info")};return(l,e)=>(o(),c("div",O,[t("div",q,[t("div",null,[t("h2",P,[d(a(B),{class:"w-8 h-8 text-rose-500"}),e[4]||(e[4]=x(" Giám sát cảnh báo ",-1))]),e[5]||(e[5]=t("p",{class:"text-zinc-500 mt-1"},"Cảnh báo thời gian thực.",-1))]),a(n).alarms.length>0?(o(),c("button",{key:0,onClick:e[0]||(e[0]=s=>u.value=!0),class:"flex items-center gap-2 px-4 py-2 bg-rose-500/10 hover:bg-rose-500/20 text-rose-400 rounded-xl border border-rose-500/20 transition-all font-semibold text-sm"},[d(a(k),{class:"w-4 h-4"}),e[6]||(e[6]=x(" Clear All Alarms ",-1))])):v("",!0)]),a(n).alarms.length===0?(o(),c("div",Z,[t("div",K,[d(a($),{class:"w-10 h-10"})]),e[7]||(e[7]=t("p",{class:"text-lg font-medium"},"All Good! Không có alarm nào.",-1)),e[8]||(e[8]=t("p",{class:"text-sm mt-1"},"Mọi thứ hoạt động vô cùng bình thường.",-1))])):(o(),c("div",W,[d(M,{name:"list"},{default:C(()=>[(o(!0),c(T,null,D(a(n).alarms,s=>(o(),c("div",{key:s.id,class:"glass-card p-5 flex items-center gap-6 border-white/5 hover:border-teal-500/30 transition-all hover:bg-white/[0.02] group"},[t("div",J,[s.event==="Motion Detection"?(o(),c("div",Q)):v("",!0),s.event==="Line Crossing"?(o(),b(a(F),{key:1,class:"w-6 h-6 text-amber-400"})):s.event==="Motion Detection"?(o(),b(a(I),{key:2,class:"w-6 h-6 text-rose-400"})):(o(),b(a(H),{key:3,class:"w-6 h-6 text-zinc-500"}))]),t("div",X,[t("div",Y,[t("span",ee,f(s.event),1)]),t("p",te,[t("span",se,[d(a(U),{class:"w-3.5 h-3.5"}),x(" "+f(s.device_ip_web||"Unknown Device"),1)]),s.channel_id_in_device?(o(),c("span",ae,[d(a(N),{class:"w-3.5 h-3.5"}),x(" "+f(s.channel_name||s.channel_id_in_device),1)])):v("",!0)]),t("p",oe,f(s.message),1)]),t("div",le,[t("p",ne,f(new Date(s.created_at).toLocaleString()),1),t("button",{onClick:ve=>_(s.id),class:"mt-2 p-2 hover:bg-rose-500/10 text-zinc-600 hover:text-rose-400 rounded-lg transition-colors",title:"Delete Alarm"},[d(a(k),{class:"w-4 h-4"})],8,re)])]))),128))]),_:1}),t("div",ie,[t("button",{onClick:e[1]||(e[1]=()=>h(!0)),disabled:r.value,class:"px-8 py-3 bg-white/5 hover:bg-white/10 rounded-2xl border border-white/10 text-zinc-300 font-bold transition-all flex items-center gap-3 disabled:opacity-50"},[r.value?(o(),b(a(V),{key:0,class:"w-5 h-5 animate-spin"})):v("",!0),x(" "+f(r.value?"Updating events...":"Load Older Events"),1)],8,ce)])])),d(S,{name:"modal"},{default:C(()=>[u.value?(o(),c("div",de,[t("div",{class:"absolute inset-0 bg-zinc-950/80 backdrop-blur-md",onClick:e[2]||(e[2]=s=>u.value=!1)}),t("div",me,[t("div",ue,[d(a(k),{class:"w-10 h-10"})]),e[9]||(e[9]=t("h3",{class:"text-2xl font-bold mb-3"},"Wipe History?",-1)),e[10]||(e[10]=t("p",{class:"text-zinc-500 text-sm leading-relaxed mb-8"}," This will permanently delete all alarm records. This action cannot be undone. ",-1)),t("div",fe,[t("button",{onClick:e[3]||(e[3]=s=>u.value=!1),class:"flex-1 py-3.5 bg-zinc-800 text-zinc-300 rounded-xl font-bold hover:bg-zinc-700 transition-colors"}," Cancel "),t("button",{onClick:y,class:"flex-1 py-3.5 bg-rose-500 text-zinc-950 rounded-xl font-bold hover:bg-rose-400 transition-colors"}," Delete All ")])])])):v("",!0)]),_:1})]))}}),ze=G(pe,[["__scopeId","data-v-8be26aa0"]]);export{ze as default};
